# AIæ³•å¾‹åŠ©æ‰‹ - å‰ç«¯å¼€å‘è§„èŒƒ

## ğŸ“‹ æ–‡æ¡£ä¿¡æ¯

**ç‰ˆæœ¬**: v1.0  
**æœ€åæ›´æ–°**: 2025-12-09  
**é€‚ç”¨èŒƒå›´**: AIæ³•å¾‹åŠ©æ‰‹ Legal Workspace v3.x

---

## ç›®å½•

1. [æŠ€æœ¯æ ˆ](#æŠ€æœ¯æ ˆ)
2. [é¡¹ç›®ç»“æ„](#é¡¹ç›®ç»“æ„)
3. [ä»£ç é£æ ¼](#ä»£ç é£æ ¼)
4. [ç»„ä»¶è§„èŒƒ](#ç»„ä»¶è§„èŒƒ)
5. [å‘½åè§„èŒƒ](#å‘½åè§„èŒƒ)
6. [æ³¨é‡Šè§„èŒƒ](#æ³¨é‡Šè§„èŒƒ)
7. [æ€§èƒ½ä¼˜åŒ–](#æ€§èƒ½ä¼˜åŒ–)
8. [é”™è¯¯å¤„ç†](#é”™è¯¯å¤„ç†)
9. [å®‰å…¨è§„èŒƒ](#å®‰å…¨è§„èŒƒ)
10. [Gitè§„èŒƒ](#gitè§„èŒƒ)

---

## æŠ€æœ¯æ ˆ

### æ ¸å¿ƒæ¡†æ¶

| æŠ€æœ¯         | ç‰ˆæœ¬ | ç”¨é€”       | CDNé“¾æ¥                                                                     |
| ------------ | ---- | ---------- | --------------------------------------------------------------------------- |
| Vue 3        | 3.x  | å‰ç«¯æ¡†æ¶   | `https://unpkg.com/vue@3/dist/vue.esm-browser.js`                           |
| D3.js        | 7.x  | æ•°æ®å¯è§†åŒ– | `https://d3js.org/d3.v7.min.js`                                             |
| Font Awesome | 6.x  | å›¾æ ‡åº“     | `https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css` |
| Supabase     | 2.x  | åç«¯æœåŠ¡   | `https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2`                      |

### å¼€å‘çº¦å®š

- **ä¸ä½¿ç”¨æ„å»ºå·¥å…·**ï¼šé¡¹ç›®é‡‡ç”¨ CDN + ES Modules æ–¹å¼ï¼Œæ— éœ€ npm/webpack/vite
- **åŸç”Ÿ CSS**ï¼šä¸ä½¿ç”¨é¢„å¤„ç†å™¨æˆ– TailwindCSS
- **ç»„ä»¶å³æ–‡ä»¶**ï¼šæ¯ä¸ª `.js` æ–‡ä»¶å®šä¹‰ä¸€ä¸ª Vue ç»„ä»¶

---

## é¡¹ç›®ç»“æ„

```
src/
â”œâ”€â”€ main.js                  # åº”ç”¨å…¥å£ã€è·¯ç”±ã€å…¨å±€æ³¨å†Œ
â”œâ”€â”€ router.js                # è·¯ç”±é…ç½®
â”œâ”€â”€ config/                  # é…ç½®æ–‡ä»¶
â”‚   â””â”€â”€ supabase.js          # Supabase é…ç½®å’Œè®¤è¯æœåŠ¡
â”œâ”€â”€ store/                   # çŠ¶æ€ç®¡ç†
â”‚   â””â”€â”€ authStore.js         # è®¤è¯çŠ¶æ€
â”œâ”€â”€ components/              # å¯å¤ç”¨ç»„ä»¶
â”‚   â”œâ”€â”€ layout/              # å¸ƒå±€ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ AppLayout.js
â”‚   â”‚   â””â”€â”€ Sidebar.js
â”‚   â””â”€â”€ HistoryModal.js      # å¼¹çª—ç»„ä»¶
â””â”€â”€ views/                   # é¡µé¢è§†å›¾
    â”œâ”€â”€ CaseList.js          # æ¡ˆä»¶åˆ—è¡¨
    â”œâ”€â”€ CaseDetail.js        # æ¡ˆä»¶è¯¦æƒ…
    â”œâ”€â”€ Login.js             # ç™»å½•
    â””â”€â”€ ...
```

### ç›®å½•èŒè´£

| ç›®å½•          | èŒè´£           | è§„åˆ™                     |
| ------------- | -------------- | ------------------------ |
| `config/`     | ç¬¬ä¸‰æ–¹æœåŠ¡é…ç½® | åªæ”¾é…ç½®å¸¸é‡å’ŒæœåŠ¡åˆå§‹åŒ– |
| `store/`      | å…¨å±€çŠ¶æ€       | ä½¿ç”¨ Vue reactive ç®¡ç†   |
| `components/` | å¯å¤ç”¨ç»„ä»¶     | ä¸é¡µé¢æ— å…³çš„é€šç”¨ç»„ä»¶     |
| `views/`      | é¡µé¢ç»„ä»¶       | å¯¹åº”è·¯ç”±çš„é¡µé¢çº§ç»„ä»¶     |
| `services/`   | ä¸šåŠ¡æœåŠ¡å±‚     | API è°ƒç”¨å°è£…ï¼ˆå¾…å»ºç«‹ï¼‰   |

---

## ä»£ç é£æ ¼

### JavaScript è§„èŒƒ

#### ç¼©è¿›ä¸ç©ºæ ¼

```javascript
// âœ… æ­£ç¡®ï¼šä½¿ç”¨ 4 ç©ºæ ¼ç¼©è¿›
export default {
    name: 'ComponentName',
    data() {
        return {
            value: ''
        };
    }
}

// âŒ é”™è¯¯ï¼šä½¿ç”¨ 2 ç©ºæ ¼æˆ– Tab
export default {
  name: 'ComponentName',
}
```

#### å¼•å·

```javascript
// âœ… ä½¿ç”¨å•å¼•å·
const message = 'Hello World'
import { router } from './router.js'

// âŒ é¿å…åŒå¼•å·ï¼ˆæ¨¡æ¿å­—ç¬¦ä¸²é™¤å¤–ï¼‰
const message = 'Hello World'
```

#### åˆ†å·

```javascript
// âœ… æ€»æ˜¯ä½¿ç”¨åˆ†å·
const name = 'Legal Workspace'
this.loadData()

// âŒ ä¸çœç•¥åˆ†å·
const name = 'Legal Workspace'
```

#### å¯¹è±¡ä¸æ•°ç»„

```javascript
// âœ… å¤šè¡Œå¯¹è±¡æœ«å°¾åŠ é€—å·
const config = {
  name: 'value',
  items: ['item1', 'item2']
}

// âœ… å¯¹è±¡è§£æ„
const { name, status } = this.caseData
```

---

## ç»„ä»¶è§„èŒƒ

### Vue ç»„ä»¶ç»“æ„

ç»„ä»¶å†…éƒ¨æŒ‰ä»¥ä¸‹é¡ºåºç»„ç»‡ï¼š

```javascript
export default {
  // 1. ç»„ä»¶æ ‡è¯†
  name: 'ComponentName',

  // 2. ç»„ä»¶ä¾èµ–
  components: {},

  // 3. Props å®šä¹‰
  props: {
    title: {
      type: String,
      required: true,
      default: ''
    }
  },

  // 4. å“åº”å¼æ•°æ®
  data() {
    return {
      // æ•°æ®å±æ€§æŒ‰åŠŸèƒ½åˆ†ç»„ï¼Œæ·»åŠ æ³¨é‡Š
      // è¡¨å•æ•°æ®
      formData: {},
      // UI çŠ¶æ€
      isLoading: false,
      showModal: false
    }
  },

  // 5. è®¡ç®—å±æ€§
  computed: {
    fullName() {
      return `${this.firstName} ${this.lastName}`
    }
  },

  // 6. ä¾¦å¬å™¨
  watch: {
    searchQuery(newVal) {
      this.debouncedSearch(newVal)
    }
  },

  // 7. ç”Ÿå‘½å‘¨æœŸé’©å­ï¼ˆæŒ‰æ‰§è¡Œé¡ºåºï¼‰
  created() {},
  mounted() {},
  beforeUnmount() {},

  // 8. æ–¹æ³•
  methods: {
    // æŒ‰åŠŸèƒ½åˆ†ç»„ï¼Œæ·»åŠ æ³¨é‡Š

    // === æ•°æ®åŠ è½½ ===
    async loadData() {},

    // === äº‹ä»¶å¤„ç† ===
    handleSubmit() {},

    // === å·¥å…·æ–¹æ³• ===
    formatDate(date) {}
  },

  // 9. æ¨¡æ¿
  template: `
        <div class="component-name">
            <!-- æ¨¡æ¿å†…å®¹ -->
        </div>
    `
}
```

### æ¨¡æ¿è§„èŒƒ

#### å±æ€§é¡ºåº

```html
<!-- æŒ‰æ­¤é¡ºåºä¹¦å†™å±æ€§ -->
<div
  ref="container"
  class="class-name"
  :class="dynamicClass"
  :style="dynamicStyle"
  v-if="condition"
  v-for="item in items"
  :key="item.id"
  @click="handleClick"
></div>
```

#### æ¡ä»¶æ¸²æŸ“

```html
<!-- âœ… ç®€å•æ¡ä»¶ä½¿ç”¨ v-if -->
<div v-if="isVisible">å†…å®¹</div>

<!-- âœ… å¤šæ¡ä»¶ä½¿ç”¨ v-else-if -->
<div v-if="status === 'loading'">åŠ è½½ä¸­...</div>
<div v-else-if="status === 'error'">å‡ºé”™äº†</div>
<div v-else>æ­£å¸¸å†…å®¹</div>

<!-- âœ… é¢‘ç¹åˆ‡æ¢ä½¿ç”¨ v-show -->
<div v-show="isExpanded">å±•å¼€å†…å®¹</div>
```

#### åˆ—è¡¨æ¸²æŸ“

```html
<!-- âœ… å§‹ç»ˆæä¾›å”¯ä¸€ key -->
<li v-for="item in items" :key="item.id">{{ item.name }}</li>

<!-- âŒ é¿å…ä½¿ç”¨ index ä½œä¸º keyï¼ˆé™¤éåˆ—è¡¨ä¸ä¼šå˜åŒ–ï¼‰ -->
<li v-for="(item, index) in items" :key="index"></li>
```

---

## å‘½åè§„èŒƒ

### æ–‡ä»¶å‘½å

| ç±»å‹     | è§„åˆ™       | ç¤ºä¾‹                              |
| -------- | ---------- | --------------------------------- |
| é¡µé¢ç»„ä»¶ | PascalCase | `CaseDetail.js`, `UserProfile.js` |
| é€šç”¨ç»„ä»¶ | PascalCase | `HistoryModal.js`, `Sidebar.js`   |
| é…ç½®æ–‡ä»¶ | camelCase  | `supabase.js`, `ragflowConfig.js` |
| æ ·å¼æ–‡ä»¶ | kebab-case | `main.css`, `design-system.css`   |

### JavaScript å‘½å

| ç±»å‹      | è§„åˆ™               | ç¤ºä¾‹                                     |
| --------- | ------------------ | ---------------------------------------- |
| ç»„ä»¶å    | PascalCase         | `CaseList`, `AppLayout`                  |
| å˜é‡/å‡½æ•° | camelCase          | `caseData`, `loadCaseList()`             |
| å¸¸é‡      | UPPER_SNAKE_CASE   | `API_BASE_URL`, `MAX_FILE_SIZE`          |
| ç§æœ‰å˜é‡  | å‰ç¼€ä¸‹åˆ’çº¿         | `_internalState`                         |
| å¸ƒå°”å€¼    | is/has/should å‰ç¼€ | `isLoading`, `hasError`, `shouldRefresh` |
| äº‹ä»¶å¤„ç†  | handle/on å‰ç¼€     | `handleSubmit`, `onFileSelect`           |
| å¼‚æ­¥æ–¹æ³•  | åŠ¨è¯å¼€å¤´           | `fetchData`, `loadCase`, `saveForm`      |

### CSS å‘½å

é‡‡ç”¨ **BEM-like** å‘½åè§„èŒƒï¼ˆBlock-Element-Modifierï¼‰ï¼š

```css
/* Block: ç‹¬ç«‹ç»„ä»¶ */
.smart-card {
}

/* Element: ç»„ä»¶å†…éƒ¨å…ƒç´  */
.smart-card-header {
}
.smart-card-body {
}
.smart-card-footer {
}

/* Modifier: çŠ¶æ€å˜ä½“ */
.smart-card.is-loading {
}
.smart-btn-primary {
}
.smart-btn-secondary {
}
```

### å‰ç¼€çº¦å®š

| å‰ç¼€      | ç”¨é€”           | ç¤ºä¾‹                                     |
| --------- | -------------- | ---------------------------------------- |
| `smart-`  | é€šç”¨ç»„ä»¶æ ·å¼   | `smart-btn`, `smart-input`, `smart-card` |
| `modern-` | ç°ä»£åŒ–å¡ç‰‡æ ·å¼ | `modern-card`                            |
| `modal-`  | æ¨¡æ€æ¡†ç›¸å…³     | `modal-overlay`, `modal-container`       |
| `status-` | çŠ¶æ€æ ·å¼       | `status-active`, `status-closed`         |
| `is-`     | çŠ¶æ€ç±»         | `is-loading`, `is-active`, `is-disabled` |

---

## æ³¨é‡Šè§„èŒƒ

### æ–‡ä»¶å¤´æ³¨é‡Š

```javascript
/**
 * CaseDetail.js - æ¡ˆä»¶è¯¦æƒ…é¡µ
 *
 * åŠŸèƒ½ï¼šå±•ç¤ºæ¡ˆä»¶è¯¦ç»†ä¿¡æ¯ï¼ŒåŒ…å«åŸºç¡€ä¿¡æ¯ã€å½“äº‹äººã€è¯æ®ã€AIåˆ†æç­‰æ ‡ç­¾é¡µ
 *
 * @author Alpha&Leader Legal Tech
 * @version 3.2
 * @lastUpdate 2025-12-09
 */
```

### åŒºå—æ³¨é‡Š

```javascript
data() {
    return {
        // ========== æ¡ˆä»¶åŸºç¡€æ•°æ® ==========
        caseData: {},

        // ========== UI çŠ¶æ€ ==========
        activeTab: 'basic',
        showEditModal: false,

        // ========== è¡¨å•æ•°æ® ==========
        editForm: {},
    };
},

methods: {
    // ========== æ•°æ®åŠ è½½æ–¹æ³• ==========
    loadCaseData(id) { },

    // ========== äº‹ä»¶å¤„ç†æ–¹æ³• ==========
    handleSave() { },

    // ========== å·¥å…·æ–¹æ³• ==========
    formatDate(date) { },
}
```

### å‡½æ•°æ³¨é‡Š

```javascript
/**
 * æ ¼å¼åŒ–é‡‘é¢æ˜¾ç¤º
 * @param {number} amount - é‡‘é¢æ•°å€¼
 * @param {string} [currency='CNY'] - è´§å¸ç±»å‹
 * @returns {string} æ ¼å¼åŒ–åçš„é‡‘é¢å­—ç¬¦ä¸²
 * @example
 * formatCurrency(50000) // "Â¥50,000.00"
 */
formatCurrency(amount, currency = 'CNY') {
    // ...
}
```

### TODO æ³¨é‡Š

```javascript
// TODO: æ¥å…¥åç«¯ API æ›¿æ¢æ¨¡æ‹Ÿæ•°æ®
// FIXME: ä¿®å¤å¤§æ–‡ä»¶ä¸Šä¼ è¶…æ—¶é—®é¢˜
// HACK: ä¸´æ—¶æ–¹æ¡ˆï¼Œç­‰å¾… Supabase ä¿®å¤åç§»é™¤
// NOTE: æ­¤å¤„éœ€è¦ç‰¹åˆ«æ³¨æ„è¾¹ç•Œæƒ…å†µ
```

---

## æ€§èƒ½ä¼˜åŒ–

### åˆ—è¡¨æ¸²æŸ“ä¼˜åŒ–

```javascript
// âœ… ä½¿ç”¨ computed è¿‡æ»¤åˆ—è¡¨
computed: {
    filteredCases() {
        return this.cases.filter(c => c.status === this.filter);
    }
}

// âŒ é¿å…åœ¨æ¨¡æ¿ä¸­ç›´æ¥è¿‡æ»¤
// v-for="item in cases.filter(c => c.status === filter)"
```

### äº‹ä»¶å¤„ç†ä¼˜åŒ–

```javascript
// âœ… é˜²æŠ–æœç´¢
data() {
    return {
        searchQuery: '',
        debouncedSearch: null
    };
},
created() {
    this.debouncedSearch = this.debounce(this.performSearch, 300);
},
methods: {
    debounce(fn, delay) {
        let timer = null;
        return function(...args) {
            clearTimeout(timer);
            timer = setTimeout(() => fn.apply(this, args), delay);
        };
    }
}
```

### å›¾ç‰‡ä¸èµ„æº

```javascript
// âœ… æ‡’åŠ è½½å›¾ç‰‡
<img :src="imageUrl" loading="lazy" alt="æè¿°">

// âœ… é¿å…å¤§å›¾ç›´æ¥åµŒå…¥
// ä½¿ç”¨ç¼©ç•¥å›¾ + ç‚¹å‡»æ”¾å¤§
```

### å¤§ç»„ä»¶æ‹†åˆ†

```javascript
// âœ… å°†å¤§ç»„ä»¶æ‹†åˆ†ä¸ºå­ç»„ä»¶
// CaseDetail.js â†’ CaseBasicInfo.js, CaseEvidence.js, CaseAI.js

// âŒ é¿å…å•æ–‡ä»¶è¶…è¿‡ 1000 è¡Œä»£ç 
```

---

## é”™è¯¯å¤„ç†

### å¼‚æ­¥é”™è¯¯å¤„ç†

```javascript
// âœ… ç»Ÿä¸€çš„é”™è¯¯å¤„ç†æ¨¡å¼
async loadData() {
    this.isLoading = true;
    this.error = null;

    try {
        const response = await api.fetchData();
        this.data = response.data;
    } catch (err) {
        this.error = 'åŠ è½½å¤±è´¥ï¼Œè¯·é‡è¯•';
        console.error('Failed to load data:', err);
    } finally {
        this.isLoading = false;
    }
}
```

### ç”¨æˆ·åé¦ˆ

```javascript
// âœ… æä¾›æ¸…æ™°çš„é”™è¯¯æç¤º
if (!this.form.name) {
  this.showToast('è¯·è¾“å…¥æ¡ˆä»¶åç§°', 'error')
  return
}

// âœ… æ“ä½œæˆåŠŸåé¦ˆ
this.showToast('ä¿å­˜æˆåŠŸ', 'success')
```

### é”™è¯¯è¾¹ç•Œ

```javascript
// âœ… ä½¿ç”¨ v-if å¤„ç†ç©ºçŠ¶æ€
<template v-if="data">
    <div class="content">{{ data.name }}</div>
</template>
<template v-else-if="isLoading">
    <div class="loading">åŠ è½½ä¸­...</div>
</template>
<template v-else>
    <div class="empty">æš‚æ— æ•°æ®</div>
</template>
```

---

## å®‰å…¨è§„èŒƒ

### XSS é˜²æŠ¤

```html
<!-- âœ… ä½¿ç”¨ v-text æˆ– {{ }} è‡ªåŠ¨è½¬ä¹‰ -->
<div>{{ userInput }}</div>

<!-- âš ï¸ è°¨æ…ä½¿ç”¨ v-htmlï¼Œä»…ç”¨äºå¯ä¿¡å†…å®¹ -->
<div v-html="trustedHtml"></div>

<!-- âŒ ç»ä¸ç›´æ¥æ’å…¥ç”¨æˆ·è¾“å…¥çš„ HTML -->
```

### æ•æ„Ÿæ•°æ®

```javascript
// âœ… å¯†ç å­—æ®µä½¿ç”¨ type="password"
<input type="password" v-model="password">

// âœ… æ•æ„Ÿæ•°æ®ä¸æ‰“å°åˆ°æ§åˆ¶å°ï¼ˆç”Ÿäº§ç¯å¢ƒï¼‰
if (process.env.NODE_ENV !== 'production') {
    console.log('Debug:', data);
}

// âœ… API Key ä¸ç¡¬ç¼–ç åœ¨ä»£ç ä¸­
const API_KEY = localStorage.getItem('api_key');
```

### è¡¨å•éªŒè¯

```javascript
// âœ… å®¢æˆ·ç«¯éªŒè¯ + æœåŠ¡ç«¯éªŒè¯
validateForm() {
    if (!this.email || !this.isValidEmail(this.email)) {
        return { valid: false, message: 'è¯·è¾“å…¥æœ‰æ•ˆçš„é‚®ç®±åœ°å€' };
    }
    return { valid: true };
}
```

---

## Gitè§„èŒƒ

### åˆ†æ”¯å‘½å

| ç±»å‹     | æ ¼å¼               | ç¤ºä¾‹                          |
| -------- | ------------------ | ----------------------------- |
| åŠŸèƒ½åˆ†æ”¯ | `feature/åŠŸèƒ½æè¿°` | `feature/ragflow-integration` |
| ä¿®å¤åˆ†æ”¯ | `fix/é—®é¢˜æè¿°`     | `fix/login-redirect-loop`     |
| ä¼˜åŒ–åˆ†æ”¯ | `refactor/æè¿°`    | `refactor/case-detail-tabs`   |

### Commit ä¿¡æ¯æ ¼å¼

```
<type>(<scope>): <subject>

<body>

<footer>
```

#### Type ç±»å‹

| Type       | æè¿°                   |
| ---------- | ---------------------- |
| `feat`     | æ–°åŠŸèƒ½                 |
| `fix`      | Bug ä¿®å¤               |
| `docs`     | æ–‡æ¡£æ›´æ–°               |
| `style`    | ä»£ç æ ¼å¼ï¼ˆä¸å½±å“åŠŸèƒ½ï¼‰ |
| `refactor` | ä»£ç é‡æ„               |
| `perf`     | æ€§èƒ½ä¼˜åŒ–               |
| `test`     | æµ‹è¯•ç›¸å…³               |
| `chore`    | æ„å»º/é…ç½®å˜æ›´          |

#### ç¤ºä¾‹

```
feat(case): æ·»åŠ æ¡ˆä»¶ç»“æ¡ˆåŠŸèƒ½

- åœ¨æ¡ˆä»¶åˆ—è¡¨é¡µæ·»åŠ ç»“æ¡ˆæŒ‰é’®
- å®ç°ç»“æ¡ˆç¡®è®¤å¯¹è¯æ¡†
- å·²ç»“æ¡ˆæ¡ˆä»¶åªè¯»ä¿æŠ¤

Closes #123
```

---

## é™„å½•

### å¸¸ç”¨å·¥å…·å‡½æ•°

```javascript
// æ—¥æœŸæ ¼å¼åŒ–
formatDate(date) {
    return new Date(date).toLocaleDateString('zh-CN');
}

// é‡‘é¢æ ¼å¼åŒ–
formatCurrency(amount) {
    return new Intl.NumberFormat('zh-CN', {
        style: 'currency',
        currency: 'CNY'
    }).format(amount);
}

// æ–‡ä»¶å¤§å°æ ¼å¼åŒ–
formatSize(bytes) {
    const units = ['B', 'KB', 'MB', 'GB'];
    let i = 0;
    while (bytes >= 1024 && i < units.length - 1) {
        bytes /= 1024;
        i++;
    }
    return `${bytes.toFixed(2)} ${units[i]}`;
}

// é˜²æŠ–
debounce(fn, delay) {
    let timer = null;
    return function(...args) {
        clearTimeout(timer);
        timer = setTimeout(() => fn.apply(this, args), delay);
    };
}
```

---

**æ–‡æ¡£ç»´æŠ¤**: AIæ³•å¾‹åŠ©æ‰‹å¼€å‘å›¢é˜Ÿ  
**æœ€åæ›´æ–°**: 2025-12-09  
**æ–‡æ¡£ç‰ˆæœ¬**: v1.0
