# 前端脚手架优化与迁移方案 (Scaffolding Migration Plan)

> **目标**: 将当前的"轻量级原型脚手架"升级为"企业级工程化脚手架"，以满足正式版的稳定性、可维护性和协作需求。

---

## 1. 核心优化维度

| 维度 | 当前状态 (轻量版) | 目标状态 (正式版) | 优化价值 |
| :--- | :--- | :--- | :--- |
| **依赖管理** | 手动引入 CDN 链接 | `package.json` + `npm/yarn` | 版本锁定，依赖可追溯，不仅限于 UMD 模块 |
| **构建工具** | 无 (运行时编译) | **Vite** | 极速 HMR，生产环境 Tree-shaking，代码压缩，性能提升 |
| **模块化** | 原生 ES Modules | ES Modules + Bundling | 减少网络请求数，支持 CommonJS 兼容，资源哈希缓存 |
| **代码规范** | `check-syntax.js` (基础) | **ESLint + Prettier** | 自动修复格式，强制代码质量，减少低级错误 |
| **样式处理** | 原生 CSS | **PostCSS / SCSS** | 自动添加浏览器前缀，嵌套语法，变量管理 |
| **类型系统** | JavaScript (JSDoc) | **TypeScript** (推荐) | 静态类型检查，智能提示，重构更安全 |

---

## 2. 详细迁移步骤 (Step-by-Step)

### 第 1 阶段：工程化初始化 (Infrastructure)
1. **初始化 npm**: 生成 `package.json`，锁定项目元数据。
2. **配置 Git**: 完善 `.gitignore` (排除 `node_modules`, `dist` 等)。
3. **引入 Vite**: 安装 `vite` 及 Vue 插件 (`@vitejs/plugin-vue`)。

### 第 2 阶段：依赖迁移 (Dependencies)
1. **替换 CDN**: 将 `index.html` 中的 `<script src="...">` 移除。
2. **安装本地包**:
   ```bash
   npm install vue vue-router
   npm install @supabase/supabase-js
   npm install d3
   ```
3. **重构导入**: 将代码中的 `const { createApp } = Vue` 修改为 `import { createApp } from 'vue'`。

### 第 3 阶段：构建配置 (Build Setup)
1. **配置 `vite.config.js`**: 设置别名 (`@/` 指向 `src/`)，配置代理等。
2. **调整入口**: 将 `index.html` 中的入口指向 `src/main.js` (Vite 能够自动处理)。
3. **配置脚本**:
   ```json
   "scripts": {
     "dev": "vite",
     "build": "vite build",
     "preview": "vite preview"
   }
   ```

### 第 4 阶段：代码质量规范 (Code Quality)
1. **ESLint**: 安装并配置 `eslint-plugin-vue`，统一代码风格。
2. **Prettier**: 配置格式化规则，确保团队代码风格一致。
3. **Husky & Lint-staged**: 配置 Git Hooks，提交前自动检查。

---

## 3. 目录结构演进对比

### 当前结构 (Lightweight)
```
legal-workspace-vue/
├── index.html          # 含大量 CDN link
├── src/views/*.js      # 纯 JS 视图
├── assets/styles/*.css # 原生 CSS
└── check-syntax.js     # 简易检查脚本
```

### 目标结构 (Professional)
```
legal-workspace-vue/
├── index.html          # 干净的入口
├── package.json        # 依赖声明
├── vite.config.js      # 构建配置
├── .eslintrc.js        # 规范配置
├── public/             # 静态资源 (无需构建)
└── src/
    ├── App.vue         # 根组件 (SFC 单文件组件)
    ├── main.js         # 入口文件
    ├── views/          # .vue 页面组件
    ├── components/     # .vue 通用组件
    ├── styles/         # SCSS/CSS 模块
    └── utils/          # 工具函数
```

---

## 4. 实施路线建议

鉴于项目当前已经有较多功能，建议采用 **"渐进式迁移"** 策略：

1. **保留现有代码逻辑**: 暂时保持 JS 文件结构，先通过 Vite 跑通开发环境。
2. **引入 npm 管理**: 先把 Vue、Supabase 等库切到 npm。
3. **视图组件化**: 逐步将 `.js` 视图文件转换为 `.vue` 单文件组件 (SFC)，享受 Vue 完整的生态优势（Scoped CSS, Template 语法糖）。

## 5. 立即行动计划 (如需执行)

如果您准备开始迁移，我可以协助您执行以下操作：
1. 生成标准 `package.json`
2. 创建 `vite.config.js`
3. 协助将 CDN 依赖转换为 npm 依赖声明
